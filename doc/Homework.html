<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yingying Xia" />

<meta name="date" content="2020-12-09" />

<title>Introduction to StatComp</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp</h1>
<h4 class="author">Yingying Xia</h4>
<h4 class="date"><code>2020-12-09</code></h4>



<div id="question-3.3" class="section level3">
<h3>Question 3.3</h3>
<ul>
<li><p>The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math display">\[F(x)=1-\left(\dfrac{b}{x}\right)^a,x\geq b&gt;0,a&gt;0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto <span class="math inline">\((2,2)\)</span> distribution. Graph the density histogram of the sample with the Pareto <span class="math inline">\((2,2)\)</span> density superimposed for comparison.</p></li>
<li><p><strong>Answer 1</strong></p>
<p>The inverse transformation <span class="math inline">\(F^{-1}(U)= b\cdot(1-U)^{-\frac{1}{a}}\)</span>,and then</p></li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level3">
<h3>Question 3.9</h3>
<ul>
<li><p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x)=\dfrac{3}{4}(1-x^2),    |x|\leq1 \tag{3.10} \]</span> Devroye and Gy<span class="math inline">\(\ddot{o}\)</span>rfi<span class="math inline">\([71,p.236]\)</span>give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U1,U2,U3\)</span>~<span class="math inline">\(Uniform(-1,1)\)</span>.If <span class="math inline">\(|U_3|\geq|U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span> , deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.10" class="section level3">
<h3>Question 3.10</h3>
<ul>
<li><p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e(3.10)\)</span>.</p></li>
<li><p><strong>Answer 3</strong> Given that <span class="math inline">\(U_1,U_2,U_3\)</span> iid <span class="math inline">\(Uniform(-1,1)\)</span>,<span class="math inline">\((U_1,U_2,U_3)\)</span>is a random point in the cube <span class="math inline">\((-1,1)^3\)</span>. Let <span class="math inline">\(X\)</span> be the distribution generated by the given algorithm: it is obviously a symmetric distribution supported on <span class="math inline">\((-1,1)\)</span>. If we take some<span class="math inline">\(\alpha \in(0,1)\)</span>, the probability that <span class="math inline">\(|X|\leq\alpha\)</span> is given by the probability that <span class="math inline">\(max{|U_1|,|U_2|\leq|U_3|}\)</span> and <span class="math inline">\(|U_2|\leq\alpha\)</span>, plus the probability that <span class="math inline">\(max{|U_1|,|U_2|\leq|U_3|}\)</span> and <span class="math inline">\(|U_3|\leq\alpha\)</span>,hence by: <span class="math display">\[\int_{0}^{\alpha}\left(\int_{0}^{u_2}(1-u_2)du_1+\int_{u_2}^{1}(1-u_1)du_1\right)du_2+\int_{0}^{\alpha}(1-u_3^2)du_3\]</span> that is <span class="math inline">\(\dfrac{3\alpha-\alpha^3}{2}\)</span>.That gives: <span class="math display">\[\mathbb P(0&lt;X\leq\alpha)=\dfrac{3\alpha-\alpha^3}{2}\]</span> and by differentiating with respect to αα we get that the PDF of <span class="math inline">\(X\)</span> is given by <span class="math inline">\(\dfrac{3}{4}(1-x^2)\)</span>, as wanted.</p></li>
</ul>
<p>2020-09-29</p>
</div>
<div id="question-3.13" class="section level3">
<h3>Question 3.13</h3>
<ul>
<li><p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\dfrac{\beta}{\beta+y})^r, \ y\geq0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(\gamma=4\)</span> and <span class="math inline">\(\beta=2\)</span>.Compare the empirical and theoretical (Pareto)distributions by graphing the density histogram of the sample and superimposing the Pareto densitycurve.</p></li>
<li><p><strong>Answer 4</strong></p></li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>2020-10-13</p>
</div>
<div id="question-5.1" class="section level3">
<h3>Question 5.1</h3>
<ul>
<li><p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi/3}sint dt\]</span> and compare your estimate with the exact value of the integral.</p></li>
<li><p><strong>Answer 1</strong></p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="fl">1e8</span>; </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>{pi<span class="op">/</span><span class="dv">3</span>})</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat, <span class="op">-</span>(<span class="kw">cos</span>({pi<span class="op">/</span><span class="dv">3</span>})<span class="op">-</span><span class="kw">cos</span>(<span class="dv">0</span>))))</span></code></pre></div>
<pre><code>## [1] 0.4999818 0.5000000</code></pre>
</div>
<div id="question-5.7" class="section level3">
<h3>Question 5.7</h3>
<ul>
<li><p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>    v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>    g &lt;-<span class="st"> </span>x[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(u <span class="op">*</span><span class="st"> </span>x[i])<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>    cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>  cdf</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="fl">1.95</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a>antithetic&lt;-<span class="cf">function</span>(x,<span class="dt">m=</span><span class="fl">1e4</span>,<span class="dt">anti=</span><span class="ot">TRUE</span>){</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a>        theta&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a>         <span class="cf">if</span>(<span class="op">!</span>anti) {<span class="co">####simple MC method</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a>              t&lt;-<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>              theta&lt;-<span class="kw">exp</span>(t)<span class="op">*</span>x</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a>         }</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a>        <span class="cf">else</span>{  <span class="co">###antithetic variate approach</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a>                u&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a>                v&lt;-x<span class="op">-</span>u</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a>                t&lt;-<span class="kw">c</span>(u,v)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>                theta&lt;-<span class="kw">exp</span>(t)<span class="op">*</span>x</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a>        }</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a>        theta</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a>}</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a>a&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dt">length=</span><span class="dv">10</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a>theta1&lt;-theta2&lt;-PR&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(a))</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a)){</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a>        t1&lt;-<span class="kw">antithetic</span>(a[i])<span class="co">##antithetic estimator</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a>        t2&lt;-<span class="kw">antithetic</span>(a[i],<span class="dt">anti=</span>F)<span class="co">##simple MC estimator</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a>        theta1[i]&lt;-<span class="kw">mean</span>(t1)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a>        theta2[i]&lt;-<span class="kw">mean</span>(t2)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a>        PR[i]&lt;-<span class="dv">100</span><span class="op">*</span>(<span class="kw">var</span>(t2)<span class="op">-</span><span class="kw">var</span>(t1))<span class="op">/</span><span class="kw">var</span>(t2)<span class="co">###variance reduction</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a>}</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x, theta1, theta2, PR), <span class="dv">10</span>))</span></code></pre></div>
<pre><code>##             [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
## x      1.9500000 1.9500000 1.9500000 1.9500000 1.9500000 1.9500000  1.950000
## theta1 0.1051709 0.2213953 0.3498362 0.4918513 0.6486669 0.8219212  1.014043
## theta2 0.1051525 0.2213602 0.3499626 0.4916755 0.6483747 0.8209256  1.011897
## PR     0.9096630 0.8085563 0.8817607 0.8834872 0.5223410 1.9466257 -1.919713
##            [,8]     [,9]     [,10]
## x      1.950000 1.950000 1.9500000
## theta1 1.226023 1.458828 1.7181484
## theta2 1.227244 1.453877 1.7187984
## PR     1.449445 2.001856 0.7389836</code></pre>
</div>
<div id="question-5.11" class="section level3">
<h3>Question 5.11</h3>
<ul>
<li><p>If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p></li>
<li><p><strong>Answer 3</strong> 解：由题意可得： <span class="math display">\[\begin{align*}
  Var(\hat\theta_c)&amp;=c^2 \cdot Var\hat\theta_1+(1-c)^2 \cdot Var\hat\theta_2+2c(1-c)cov(\hat\theta_1,\hat\theta_2)\\
  &amp;=Var(\hat\theta_1-\hat\theta_2) \cdot c^2-2(Var\hat\theta_2-cov(\hat\theta_1,\hat\theta_2)) \cdot c+Var\hat\theta_2\\
\end{align*}\]</span><span class="math inline">\(\\\)</span> 又因为<span class="math inline">\(Var(\hat\theta_1-\hat\theta_2)&gt;0\)</span>,则<span class="math inline">\(\\\)</span> <span class="math inline">\(c^*=\dfrac{Var\hat\theta_2-cov(\hat\theta_1,\hat\theta_2)}{Var(\hat\theta_1-\hat\theta_2)}\)</span>时，估计<span class="math inline">\(\hat\theta_c\)</span>的方差最小。</p></li>
</ul>
<p>2020-10-20</p>
</div>
<div id="question-5.13" class="section level3">
<h3>Question 5.13</h3>
<ul>
<li><p>Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\dfrac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad x&gt;1\]</span>. Which of your two importance functions should produce the smaller variance in estimating<span class="math display">\[\int_1^{\infty}\dfrac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p></li>
<li><p><strong>Answer 1</strong></p></li>
</ul>
<p>  The candidates for the importance functions are <span class="math display">\[f_1=\frac{2}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}},\quad x&gt;1.\]</span> <span class="math display">\[f_2=e^{1-x},\quad x&gt;1.\]</span>   As can be seen from the figure below, the curves of f1(x) and f2(x) are ‘close’ to g(x).</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>  Calculate the mean and standard deviation:</p>
<pre><code>##   func       est         sd
## 1   f1 0.4003573 0.04424692
## 2   f2 0.4013249 0.15852998</code></pre>
<p>  We can see that the mean of these two functions are close, but the variance of <span class="math inline">\(f_1\)</span> is smaller,so <span class="math inline">\(f_1\)</span> is a better importance function.</p>
</div>
<div id="question-5.15" class="section level3">
<h3>Question 5.15</h3>
<ul>
<li><p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>n&lt;-<span class="dv">10000</span>;k&lt;-<span class="dv">5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>g&lt;-<span class="cf">function</span>(x){</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>}</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>f&lt;-<span class="cf">function</span>(x){</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="co">#Method1: Stratified Importance Sampling</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>s&lt;-n<span class="op">/</span>k</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>est&lt;-<span class="kw">numeric</span>(k)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>var&lt;-<span class="kw">numeric</span>(k)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>  u&lt;-<span class="kw">runif</span>(s,(i<span class="dv">-1</span>)<span class="op">/</span>k,i<span class="op">/</span>k)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co">#inverse transform</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>  est[i]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x)) <span class="co">#estimate in each subinterval</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>  var[i]&lt;-<span class="kw">sd</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x))<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(s<span class="dv">-1</span>)<span class="op">/</span>s <span class="co">#variance in each subinterval</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>}</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>lambda_hat1.est&lt;-<span class="kw">mean</span>(est)  <span class="co">#estimate of method1</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>lambda_hat1.sd&lt;-<span class="kw">sqrt</span>(<span class="kw">sum</span>(var)<span class="op">/</span>s) <span class="co">#sd of method1</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a><span class="co">#Method2: Importance Sampling</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a>v&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>y&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>v<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co">#inverse transform</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a>lambda_hat2.est&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(y)<span class="op">/</span><span class="kw">f</span>(y))  <span class="co">#estimate of method2</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a>lambda_hat2.sd&lt;-<span class="kw">sd</span>(<span class="kw">g</span>(y)<span class="op">/</span><span class="kw">f</span>(y)) <span class="co">#sd of method2</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true"></a><span class="co">#Compare</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true"></a><span class="kw">c</span>(lambda_hat1.est,lambda_hat2.est)</span></code></pre></div>
<pre><code>## [1] 0.5247828 0.5236727</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">c</span>(lambda_hat1.sd,lambda_hat2.sd)</span></code></pre></div>
<pre><code>## [1] 0.001037033 0.096373010</code></pre>
<p>  The results show that the standard deviation of stratified importance sampling estimation is smaller.</p>
</div>
<div id="question-6.4" class="section level3">
<h3>Question 6.4</h3>
<ul>
<li><p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p></li>
<li><p><strong>Answer 3</strong></p></li>
</ul>
<p>  From the meaning of the question we have random variable <span class="math inline">\(X\)</span> that <span class="math display">\[logX\sim N(\mu,\sigma^2)\]</span>   then we can estimate <span class="math inline">\(\mu\)</span> by its random sample <span class="math inline">\(X_1,...,X_n\)</span>: <span class="math display">\[\hat\mu=\frac{1}{n}\sum_{i=1}^nlogX_i\]</span>   and we have: <span class="math display">\[\frac{\sqrt{n}(\hat\mu-\mu)}{S}\sim t(n-1), \quad S^2=\frac{1}{n-1}\sum_{i=1}^n(logX_i-\hat\mu)^2\]</span>   then we can get the CI: <span class="math display">\[\left( { \hat\mu-\frac{S}{\sqrt n}t_{1-\frac{\alpha}{2}}(n-1),  \hat\mu+\frac{S}{\sqrt n}t_{1-\frac{\alpha}{2}}(n-1)} \right)\]</span></p>
<p>  The code for obtaining empirical estimates of confidence levels is as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1227</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>mu &lt;-<span class="st"> </span><span class="dv">1</span>;sigma &lt;-<span class="st"> </span><span class="dv">2</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,mu,sigma)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>  <span class="kw">abs</span>(<span class="kw">sqrt</span>(n<span class="op">/</span><span class="kw">var</span>(<span class="kw">log</span>(x)))<span class="op">*</span>(<span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span>mu)) </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>})</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="kw">sum</span>(CL<span class="op">&lt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 950</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">mean</span>(CL<span class="op">&lt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 0.95</code></pre>
<p>It turns out to be 95% percent!</p>
</div>
<div id="question-6.5" class="section level3">
<h3>Question 6.5</h3>
<ul>
<li><p>Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p></li>
<li><p><strong>Answer 4</strong></p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>lambda&lt;-<span class="dv">2</span>;alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>CL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> { </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>  <span class="kw">abs</span>(<span class="kw">sqrt</span>(n<span class="op">/</span><span class="kw">var</span>(x))<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>lambda))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>})</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="kw">sum</span>(CL<span class="op">&lt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 918</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">mean</span>(CL<span class="op">&lt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<p>The t-interval results are quite different from the simulation results in example 6.4.</p>
<p>2020-10-27</p>
</div>
<div id="question-6.7" class="section level3">
<h3>Question 6.7</h3>
<ul>
<li><p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p></li>
<li><p><strong>Answer 1</strong></p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a>n&lt;-<span class="st"> </span><span class="dv">30</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>a&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(.<span class="dv">1</span>,<span class="fl">3.6</span>,.<span class="dv">7</span>),<span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">49</span>,<span class="dv">1</span>))<span class="co">#parameters of beta(a,a) distribution</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>t&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">1</span>)<span class="co">#degrees of freedom of t distribution</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>}</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(a) </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a>pwr1 &lt;-<span class="st"> </span>pwr2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a><span class="co">#critical value for the skewness test </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a>sktests1 &lt;-<span class="st"> </span>sktests2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a[j],a[j])</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n,t[j])</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a>    sktests1[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true"></a>    sktests2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(y)) <span class="op">&gt;=</span><span class="st"> </span>cv) </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true"></a>    }</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true"></a>  pwr1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests1) </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true"></a>  pwr2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests2) </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true"></a>}</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true"></a><span class="co">#plot power vs parameters of beta distribution</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true"></a><span class="kw">plot</span>(a, pwr1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;parameters of beta distribution&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.08</span>))</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true"></a>se1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr1<span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr1) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true"></a><span class="co">#add standard errors </span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true"></a><span class="kw">lines</span>(a, pwr1<span class="op">+</span>se1, <span class="dt">lty =</span> <span class="dv">3</span>) </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true"></a><span class="kw">lines</span>(a, pwr1<span class="op">-</span>se1, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co">#plot power vs parameters of t distribution</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="kw">plot</span>(t, pwr2, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;parameters of t distribution&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>se2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr2<span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr2) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="co">#add standard errors </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a><span class="kw">lines</span>(t, pwr2<span class="op">+</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="kw">lines</span>(t, pwr2<span class="op">-</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co">#when put them together</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="kw">plot</span>(a, pwr1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;parameters of distribution&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="kw">lines</span>(t, pwr2, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>       <span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>,<span class="st">&quot;t&quot;</span>) ,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>       <span class="dt">lty=</span><span class="dv">3</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>  Different from the symmetric beta distribution, the potential function of the heavy-tailed distribution <span class="math inline">\(t(\nu)\)</span> is greater than 0.05, and with the increase of freedom, power decreases and tends to 0.05 gradually.<span class="math inline">\(\\\)</span></p>
<p>  Therefore, the T-distribution and the normal distribution are closer than the symmetric beta distribution, which is also consistent with the intuition.</p>
</div>
<div id="question-6.8" class="section level3">
<h3>Question 6.8</h3>
<ul>
<li><p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat\alpha\dot=0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)<span class="co">#sample size</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>power &lt;-<span class="st"> </span>power2 &lt;-<span class="st">  </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a>  X &lt;-<span class="st"> </span>x<span class="op">-</span><span class="kw">mean</span>(x)<span class="co">#centered by sample mean</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>  Y &lt;-<span class="st"> </span>y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a>}</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a>  power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma1)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma2)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a>  <span class="kw">count5test</span>(x,y)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true"></a>  }))</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true"></a>  pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma1)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma2)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true"></a>    Ftest &lt;-<span class="st"> </span><span class="kw">var.test</span>(x, y, <span class="dt">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true"></a>                      <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true"></a>                      <span class="dt">conf.level =</span> <span class="fl">0.945</span>, ...)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true"></a>    Ftest<span class="op">$</span>p.value})</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true"></a>  power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues<span class="op">&lt;=</span><span class="fl">0.055</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true"></a>}</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true"></a>power</span></code></pre></div>
<pre><code>## [1] 0.3216 0.8450 0.9973</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>power2</span></code></pre></div>
<pre><code>## [1] 0.4080 0.9816 1.0000</code></pre>
<p>  As can be seen from the results, power increases as the sample size increases.<span class="math inline">\(\\\)</span></p>
<p>  Secondly, power is relatively large in small, medium and large samples.<span class="math inline">\(\\\)</span></p>
<p>  In addition, the Power of the F test is larger than the CountFive test for small, medium, and large samples.</p>
</div>
<div id="question-6.c" class="section level3">
<h3>Question 6.C</h3>
<ul>
<li><p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as<span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\sum { }^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\dfrac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar X)^T\widehat\sum { }^{-1}(X_j-\bar X))^3\]</span> where <span class="math inline">\(\widehat\sum\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p></li>
<li><p><strong>Answer 3</strong></p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;MASS&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>n &lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)  <span class="co">#sample sizes </span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a>sk &lt;-<span class="cf">function</span>(x) { </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a>  n&lt;-<span class="kw">nrow</span>(x)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d) {</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a>    x[,i]&lt;-x[,i]<span class="op">-</span><span class="kw">mean</span>(x[,i])</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a>  }</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true"></a>  s&lt;-<span class="kw">solve</span>(<span class="kw">cov</span>(x))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true"></a>  b&lt;-<span class="kw">mean</span>((x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">*</span>(x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">*</span>(x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x)))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true"></a>  <span class="kw">return</span>(b<span class="op">*</span>n<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true"></a>}</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true"></a><span class="co">#n is a vector of sample sizes </span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results </span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true"></a><span class="co">#num. repl. each sim.</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true"></a>mu&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,d)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true"></a>sigma&lt;-<span class="kw">diag</span>(<span class="kw">rep</span>(<span class="dv">1</span>,d))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) { </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk</span>(x) <span class="op">&gt;=</span><span class="st"> </span>cv) </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true"></a>    }</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true"></a>}</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.000 0.007 0.033 0.032 0.048 0.050</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>n &lt;-<span class="dv">20</span> <span class="co">#sample sizes </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>sk &lt;-<span class="cf">function</span>(x) { </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a>  n&lt;-<span class="kw">nrow</span>(x)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d) {</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>    x[,i]&lt;-x[,i]<span class="op">-</span><span class="kw">mean</span>(x[,i])</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>  }</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a>  s&lt;-<span class="kw">solve</span>(<span class="kw">cov</span>(x))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a>  b&lt;-<span class="kw">mean</span>((x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">*</span>(x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">*</span>(x<span class="op">%*%</span>s<span class="op">%*%</span><span class="kw">t</span>(x)))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>  <span class="kw">return</span>(b<span class="op">*</span>n<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a>}</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.05</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="fl">0.9</span>, <span class="fl">.15</span>)) </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon) </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#critical value for the skewness test </span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true"></a>  e &lt;-<span class="st"> </span>epsilon[j] </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true"></a>    sig &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,d),<span class="kw">diag</span>(<span class="kw">rep</span>(sig[<span class="dv">1</span>],d)))</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true"></a>      sigma&lt;-<span class="kw">diag</span>(<span class="kw">rep</span>(sig[k],d))</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true"></a>      x &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,d),sigma))</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true"></a>    }</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk</span>(x) <span class="op">&gt;=</span><span class="st"> </span>cv) </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true"></a>  }</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true"></a>}</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true"></a><span class="co">#plot power vs epsilon </span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors </span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>) </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6OmY6OpA6kNtmAABmADpmOgBmtttmtv+QOgCQZgCQ2/+2ZgC22/+2///bkDrbtmbb////tmb/25D/27b//7b//9v///81h/HBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHUklEQVR4nO2di5IaNxBFlcSLE2M7m5CQgNn5/88084BiWMSVerrVvXBP2VuesqY1nNJbYjZ15C7J+wGiQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAMqC0ofBS5BuODsoCEBBgMaC6qu2NyxBAAoCUBCAggBRBYVpxoMKSvo5CokpKFlkKSOqoL6KUVD+f9PkyJ/YgpJ/PTMStEnp5e31+An/FIUbJyNjS+1cjmwEbT/9f3T00nWH9RdJuItGOjl3+SaC3l6PWna//N2NqmrDDU4ukrhOb00EHdbHmrX79d/u9LM43LnzuhYytkfpxv8YE6sETa3OvRtaDyGN26BBVXG4dPqTuSed9DU0FKoXA4KGJOn0oxGhxkElgnASXUIJGioQnsY2baWtBW2rerGS3nxK0spSrEX78qdpVoiiVbGqEC0sfWRBTYaMRoKGLv5IpgW6Ha724zaZyBoNFNM0PtylioGi5NOalyK7qcZIzVRD8Fntq5ndZHWkZrIq/Ki2jgKVIOnHtG2KrNqgqQhVtEHyT2layYx6scN67MUy5Ue1BE13G63yxxkHLcogXfzVJYyghfGT1Tw/iqDl4e+sRi4Nq5tQGG5x/LEFelBBKuO9B26DCtbJimJa7MRGEKTYvOobejBB+tQLyu7kiPN9MEEXM1GtfFXbDuWpmaCK5SboC/JVnSToGpKUoARWC+9FySzae7WsiqFsx0G6wTUDPqYgxZm9qIq9aOdrUIK0QgpK0NQIDadblPK16OLdStDEYb2oM2sgSKcUyQT1hUixBNmsKesYEgjar2RdfD5fq0V3nxK0sG7dytdsV8KnBPVFaHE/lrIXmijUMmEjvc0frrtgv8omaiNIwZBJL3aejeQnJLPZfNCJ/IBA0AbPxab9Qv8StBzRSBr38Id1v2UYQlBatuRtNhfbHC0WCjKuYmnRepNE0NDEZDeVT2zTlxiCpryEmUgWzMbvGMB6tl/9Viio9BmEjPtBzQS9vY6fegPL0NtrfizQVlCSF1NBI/11LDrLVl4v8rXv5Zfsu8lLUO5o1JyCg+QtTmLKt6UlbdBQcbYlQ+n3UW6tSbcZBgl7sgWL9sJ1+3f5hvtSgewuuzXphjMNQVNkJKjmIHnLiUa9IRtBVQfJGwoSTDlMBNUdA247Va1tq00EVR0kb73YUWnIvwQ1F1SXoVUbVH6QvPlyWV1DbdSLVRwk91gtq3DkPw5yEVRu6DkFVdTrJxVU3pk9raBSQ+6C/PZ8yjJ+YkFT9iB/f0G6cSvBa43PLWh6y8XdJMWxlj5MJpyvoPHnvWfwFuTbBCXcmXkLcm+DUDVrLOjdor33yY7zV6hyz+FdgrwFjdypau6CdMPKyb1dl4JOZL4DQ0EX3Ho1lrOgGE3QmRulyFuQblQNrpoiCrri+jQaBd3m/IUqCrrB5eDRSFDp3nxMQd15GmslqHhvPq6g05ErE0GlO6uu72K/j20JKtybV3plhw2mbVBZCSpYjPHEtBcr2psPLmjCqBcr2Zt/akFF4aqquBeuA8XAvdgZa0F1byQPiPeadHi8F8zCQ0EA58lqfJwnq/Fxm2p8GCwEFUxWi4NGSqJ2f0EJKg4aKYne/XiyWhw0UhLF++FktThopCSm90uDRkpier80aKQkpvdLg0ZKYnq/NGikJKb3S4NGSmJ6/8NDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAJqCdpcvfN9J3/5+fSN+sSOMsk1Fr4G+iaKg/lWeu9NTzS7EUfpr/PZUFKV/u+hOakhP0LgptHl5fyGO0g3bBAJBV8/yInuWAT1B4ytwp4NDswtxlP5fn/4SCJpFCSPoc1+ipy3X2YU4ynApaYPmUYJUsbHKTxV/diGOMlQViaCr7MUdRhddUL/DvVzQ5liS9ivhL+ALXcWGi8VVTNweDoRupLfTUZXq5mMWRVyaB6J387ISNIsy2pK+Jzv8QFE2kp5FCdIGDTWif6Zx3LGV9hyzKJ10qjGL0v/KEOkvSeVkFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQHhB/61S+kP8692XE13Q/vP36QydE9EFHb5KDzgrEV1Q9+Nb/qWELYgu6LD+7vsA0QVJT++qEV3QfvW9+7EWflNHg+iCuv23lH7/xy//8IK8oSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAD8BnnQ8a35ckzkAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>  If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ul>
<li><p>1.What is the corresponding hypothesis test problem?</p></li>
<li><p>2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>3.What information is needed to test your hypothesis?</p></li>
<li><p><strong>Answer 4</strong></p></li>
</ul>
<p>  1.<span class="math inline">\(H_0:\)</span> power1 <span class="math inline">\(=\)</span> power2 vs <span class="math inline">\(H_1:\)</span> power1 <span class="math inline">\(\neq\)</span> power2</p>
<p>  2.These are all possible except for the two-sample t-test, because the two-sample t-test requires the sample to be independent.</p>
<p>  3.We need the power value generated from the sample data of 10000 trials and the corresponding <span class="math inline">\(\dfrac {(x_i-y_i)^2} {x_i+y_i} \sim \chi^2_1\)</span>. We also need the chi-square quantile.</p>
<p>2020-11-03</p>
</div>
<div id="question-7.1" class="section level3">
<h3>Question 7.1</h3>
<ul>
<li><p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p></li>
<li><p><strong>Answer 1</strong></p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>y &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>z &lt;-<span class="st"> </span>law<span class="op">$</span>GPA</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(y, z)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(y[<span class="op">-</span>i],z[<span class="op">-</span>i])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a><span class="kw">print</span>(bias) <span class="co">#jackknife estimate of bias</span></span></code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<p>  So that,the jackknife estimate of the bias is -0.006473623,and the standard error is 0.1425186.</p>
</div>
<div id="question-7.5" class="section level3">
<h3>Question 7.5</h3>
<ul>
<li><p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&#39;aircondit&#39;</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit,<span class="dt">R=</span><span class="dv">2000</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>                 <span class="dt">statistic =</span> <span class="cf">function</span>(x,i){<span class="kw">mean</span>(x[i,<span class="dv">1</span>])})</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   ( 33.9, 180.8 )   ( 28.2, 169.7 )   ( 46.5, 188.0 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a>boot.BCa &lt;-<span class="st"> </span><span class="cf">function</span>(x,th0,th,stat,<span class="dt">conf=</span>.<span class="dv">95</span>){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a>  N &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a>  alpha &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">+</span><span class="kw">c</span>(<span class="op">-</span>conf,conf))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true"></a>  zalpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true"></a>  z0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">sum</span>(th<span class="op">&lt;</span>th0)<span class="op">/</span><span class="kw">length</span>(th))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true"></a>  th.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true"></a>    J &lt;-<span class="st"> </span>N[<span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true"></a>    th.jack[i] &lt;-<span class="st"> </span><span class="kw">stat</span>(x[<span class="op">-</span>i, ],J)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true"></a>  }</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true"></a>  L &lt;-<span class="st"> </span><span class="kw">mean</span>(th.jack)<span class="op">-</span>th.jack</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true"></a>  a &lt;-<span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true"></a>  adj.alpha &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z0<span class="op">+</span>(z0<span class="op">+</span>zalpha)<span class="op">/</span><span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>(z0<span class="op">+</span>zalpha))</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true"></a>  limits &lt;-<span class="st"> </span><span class="kw">quantile</span>(th,adj.alpha,<span class="dt">type =</span> <span class="dv">6</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;est&quot;</span>=th0,<span class="st">&quot;BCa&quot;</span>=limits))</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true"></a>}</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(aircondit)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true"></a>x &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true"></a>theta.b &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true"></a>  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true"></a>  x &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours[i]</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true"></a>  theta.b[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true"></a>}</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true"></a>stat &lt;-<span class="st"> </span><span class="cf">function</span>(dat,index){</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true"></a>  <span class="kw">mean</span>(dat[index])</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true"></a>}</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true"></a><span class="kw">boot.BCa</span>(x,<span class="dt">th0 =</span> theta.hat,<span class="dt">th=</span>theta.b,<span class="dt">stat=</span>stat)</span></code></pre></div>
<pre><code>## $est
## [1] 108.0833
## 
## $BCa
## 5.556856% 97.39056% 
##  55.66667 185.64877</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&#39;aircondit&#39;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit,<span class="dt">R=</span><span class="dv">2000</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a>                 <span class="dt">statistic =</span> <span class="cf">function</span>(x,i){<span class="kw">mean</span>(x[i,<span class="dv">1</span>])})</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.8, 181.9 )   ( 26.2, 170.3 )  
## 
## Level     Percentile            BCa          
## 95%   ( 45.8, 190.0 )   ( 56.2, 228.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>  All four intervals cover the 1/λ=108.0833. One reason for the difference in the percentile and normal confidence intervals could be that the sampling distribution of the statistic is not close to normal. When the sampling distribution of the statistic is approximately normal, the percentile interval will agree with the normal interval.</p>
</div>
<div id="question-7.8" class="section level3">
<h3>Question 7.8</h3>
<ul>
<li><p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p></li>
<li><p><strong>Answer 3</strong></p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="kw">data</span>(scor)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co"># number of rows (data size)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true"></a><span class="co"># Jackknife</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true"></a>theta_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true"></a>x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true"></a>lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true"></a>theta_j[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true"></a><span class="co"># the i-th entry of theta_j is the i-th &quot;leave-one-out&quot; estimation of theta</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true"></a>}</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true"></a>bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_j) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true"></a><span class="co"># the estimated bias of theta_hat, using jackknife</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true"></a>se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true"></a><span class="co"># the estimated se of theta_hat, using jackknife</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true"></a><span class="co"># print the answers</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true"></a>bias_jack</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a>se_jack</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<p>So,the jackknife estimates of bias 0.001069139 and standard error is 0.04955231.</p>
</div>
<div id="question-7.11" class="section level3">
<h3>Question 7.11</h3>
<ul>
<li><p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p></li>
<li><p><strong>Answer 4</strong></p></li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {<span class="co">#leave the first pair of data</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a>  mag &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a>  che &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> k<span class="op">:</span>(n<span class="dv">-1</span>)) {<span class="co">#leave the second pair of data</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a>    y &lt;-<span class="st"> </span>mag[<span class="op">-</span>i] </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a>    x &lt;-<span class="st"> </span>che[<span class="op">-</span>i]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true"></a>    z &lt;-<span class="st"> </span><span class="kw">c</span>(chemical[k],chemical[i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>z</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true"></a>    e1[k,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1[<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(magnetic[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat1[<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true"></a>    </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>z</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true"></a>    e2[k,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2[<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat2[<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true"></a>    </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>z</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true"></a>    e3[k,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3[<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat3[<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true"></a>    </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x)) </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(z) </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4) </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true"></a>    e4[k,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4[<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat4[<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span>     </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true"></a>  }</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true"></a>}</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1),<span class="kw">mean</span>(e2),<span class="kw">mean</span>(e3),<span class="kw">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.20298 17.53301 18.10671 20.08101</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<p>2020-11-10</p>
</div>
<div id="question-8.3" class="section level3">
<h3>Question 8.3</h3>
<ul>
<li><p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p></li>
<li><p><strong>Answer 1</strong></p></li>
</ul>
<p>The hypothesis test is: <span class="math display">\[H_0:VarX = VarY\longleftrightarrow H_1:VarX \neq VarY\]</span> First, we write a function to calculate the extreme points.</p>
<p>We implement a permutation test for equal variance based on the maximum number of extreme points following the steps below.</p>
<p>Compute the observed test statistic (i.e. extreme points) <span class="math inline">\(\hat{\theta}(X, Y)=\hat{\theta}(Z, \nu)\)</span>.</p>
<p>For each replicate, indexed b = 1, . . ., B:</p>
<p>Generate a random permutation <span class="math inline">\(\pi_{b}=\pi(\nu)\)</span>. Compute the statistic <span class="math inline">\(\hat{\theta}^{(b)}=\hat{\theta}^{*}\left(Z, \pi_{b}\right)\)</span>. The large values of <span class="math inline">\(\hat{\theta}\)</span> support the alternative, compute the empirical p-value by <span class="math display">\[\hat p=\dfrac{1+\#\begin{Bmatrix} \hat{\theta^b}\geq\hat{\theta}   \end{Bmatrix}
}{B+1}=\dfrac{\begin{Bmatrix} 1+\sum_{b=1}^BI\left(\hat\theta^b\geq\hat\theta\right) \end{Bmatrix}}{B+1}\]</span> Reject <span class="math inline">\(H_0\)</span> at significance level <span class="math inline">\(\alpha\)</span> if <span class="math inline">\(\hat{p} \leq \alpha\)</span>. We estimate the type1 error based on 1000 Monte Carlo experiments, and we set the significance level at 0.05</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true"></a>}</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>    <span class="co">#significance level</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span><span class="dv">30</span>;n2 &lt;-<span class="dv">50</span> <span class="co">#two different sample size</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>;sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>   <span class="co"># the times of Monte Carlo experiments</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true"></a>p_value &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true"></a>  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true"></a>  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true"></a>  ts &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">199</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true"></a>  ts[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">maxout</span>(x1,x2)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">199</span>){</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true"></a>    ind &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2),<span class="dt">size =</span> n1,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true"></a>    x.perm &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)[ind]; y.perm &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)[<span class="op">-</span>ind]</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true"></a>    ts[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">maxout</span>(x.perm,y.perm)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true"></a>  }</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true"></a>  <span class="kw">mean</span>(ts <span class="op">&gt;=</span><span class="st"> </span>ts[<span class="dv">1</span>])</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true"></a>})</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true"></a><span class="co">#estimate the type1 error</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">mean</span>(p_value <span class="op">&lt;</span><span class="st"> </span>alpha))</span></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<p>As a result, we can see that the permutation method control the type1 error quite well.</p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li><p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p></li>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df(heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<p>1.For unequal variances and equal expectations</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a><span class="kw">library</span>(RANN) <span class="co"># implementing a fast algorithm</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="co"># for locating nearest neighbors</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true"></a><span class="co"># (alternative R package: &quot;yaImpute&quot;)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co"># pooled samplec8</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true"></a><span class="co">#R code implementing NN test</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true"></a>}</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true"></a><span class="co"># Power comparison </span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.8</span>; <span class="kw">set.seed</span>(<span class="dv">1245</span>)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true"></a>}</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true"></a>}</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.3</span>;</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.34 0.43 0.59</code></pre>
<p>2.For unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.5</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>}</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true"></a>}</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true"></a>pow2</span></code></pre></div>
<pre><code>## [1] 0.43 0.64 0.78</code></pre>
<p>3.Non-normal distributions</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="fl">1e2</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true"></a> x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol =</span> p);</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="dv">1</span>))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true"></a>}</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true"></a>pow3</span></code></pre></div>
<pre><code>## [1] 0.39 0.67 0.76</code></pre>
<p>4.Unbalanced samples</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; <span class="kw">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span><span class="dv">30</span>; n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true"></a>}</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">3.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1</span>)<span class="op">$</span>p.value</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true"></a>}</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true"></a>pow4</span></code></pre></div>
<pre><code>## [1] 0.41 0.39 0.86</code></pre>
<pre><code>We can see that Ball could be more powerful for non-location family distribution,and Energy test and Ball test are generally more powerful than
nearest NN test, but the former two cannot uniformly each other.

2020-11-17

### Question 1
+  Implement a random walk Metropolis sampler for generating the standard
Laplace distribution (see Exercise 3.2). For the increment, simulate from a
normal distribution. Compare the chains generated when different variances
are used for the proposal distribution. Also, compute the acceptance rates of
each chain.

-  **Answer 1**


```r
# density of the standard Laplace distribution
r&lt;-function(x)0.5*exp(-abs(x))
rw.Metropolis &lt;- function(sigma, x0, N) { 
  x &lt;- numeric(N) 
  x[1] &lt;- x0 
  u &lt;- runif(N) 
  k&lt;-0 
  for (i in 2:N) {
    y &lt;- rnorm(1, x[i-1], sigma) 
    if (u[i] &lt;= (r(y) / r(x[i-1]))) x[i] &lt;- y else { 
      x[i] &lt;- x[i-1] 
      k&lt;-k+1
    } 
  }
return(list(x=x, k=k)) 
}
N &lt;- 5000 
sigma &lt;- c(.05, .5, 2, 16)
x0 &lt;- 25 
rw1 &lt;- rw.Metropolis(sigma[1], x0, N) 
rw2 &lt;- rw.Metropolis(sigma[2], x0, N) 
rw3 &lt;- rw.Metropolis(sigma[3], x0, N) 
rw4 &lt;- rw.Metropolis(sigma[4], x0, N)

#the acceptance rates of each chain
print(1-c(rw1$k, rw2$k, rw3$k, rw4$k)/2000)

plot(1:N,rw1$x,type = &quot;l&quot;)
plot(1:N,rw2$x,type = &quot;l&quot;)
plot(1:N,rw3$x,type = &quot;l&quot;)
plot(1:N,rw4$x,type = &quot;l&quot;)</code></pre>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<ul>
<li><p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p></li>
<li><p><strong>Answer 2</strong></p></li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a>r&lt;-<span class="cf">function</span>(x)<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) { </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi) </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi) </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true"></a>  </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true"></a>}</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true"></a>normal.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) { </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true"></a>  <span class="co">#generates a Metropolis chain for standard Laplace distribution</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution </span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true"></a>  <span class="co">#and starting value X1 </span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N) </span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1 </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) { </span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>] </span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) </span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">r</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">r</span>(x[i<span class="dv">-1</span>]))) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> </span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>] </span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true"></a>  }</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true"></a>  <span class="kw">return</span>(x) </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true"></a>  }</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#parameter of proposal distribution </span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true"></a>k &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> </span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true"></a><span class="co">#number of chains to generate </span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true"></a><span class="co">#length of chains </span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true"></a><span class="co">#burn-in length</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true"></a><span class="co">#generate the chains </span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n) </span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) X[i, ] &lt;-<span class="st"> </span><span class="kw">normal.chain</span>(sigma, n, x0[i])</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum)) </span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi)) </span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true"></a><span class="co">#plot psi for the four chains </span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) </span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j]) </span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<ul>
<li><p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p></li>
<li><p><strong>Answer 3</strong> Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)\]</span> and <span class="math display">\[S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right)\]</span> for k =4: 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p></li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a>c_k &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>  <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a>}</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true"></a>res &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true"></a>  <span class="kw">pt</span>(<span class="kw">c_k</span>(k<span class="dv">-1</span>,a),<span class="dt">df =</span> k<span class="dv">-1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">c_k</span>(k,a),<span class="dt">df =</span> k)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true"></a>}</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true"></a>root.curve &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>),<span class="cf">function</span>(k){<span class="kw">uniroot</span>(res,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.0001</span>),<span class="dt">k=</span>k)<span class="op">$</span>root})<span class="co">#因为是开区间，所以下界比0大一点，上界比根号k小一点</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true"></a>result &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>),root.curve)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result)</span></code></pre></div>
<p>2020-11-24</p>
</div>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<ul>
<li>A-B-O blood type problem
<table>
<tr>
<th>
Genotype
</th>
<th>
AA
</th>
<th>
BB
</th>
<th>
OO
</th>
<th>
AO
</th>
<th>
BO
</th>
<th>
AB
</th>
<th>
Sum
</th>
</tr>
<tr>
<th>
Frequency
</th>
<th>
p^2
</th>
<th>
q^2
</th>
<th>
r^2
</th>
<th>
2pr
</th>
<th>
2qr
</th>
<th>
2pq
</th>
<th>
1
</th>
</tr>
<tr>
<th>
Count
</th>
<th>
nAA
</th>
<th>
nBB
</th>
<th>
nOO
</th>
<th>
nAO
</th>
<th>
nBO
</th>
<th>
nAB
</th>
<th>
n
</th>
</tr>
</table></li>
<li><strong>Answer 1</strong></li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1227</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>n_A. &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true"></a>n_B. &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true"></a>n_AB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true"></a>n_OO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true"></a>p0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true"></a>q0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">-</span>p0)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true"></a>likelihood_e &lt;-<span class="st"> </span><span class="cf">function</span>(prob,p0,q0){</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true"></a>  r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0 </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true"></a>  p &lt;-<span class="st"> </span>prob[<span class="dv">1</span>]; q &lt;-<span class="st"> </span>prob[<span class="dv">2</span>] ; r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true"></a>  <span class="op">-</span><span class="st"> </span>n_A. <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p)<span class="op">*</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0<span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0))) <span class="op">-</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true"></a><span class="st">    </span>n_B. <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(q)<span class="op">*</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0<span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0))) <span class="op">-</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true"></a><span class="st">    </span>n_AB <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>n_OO <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(r) </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true"></a>}</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true"></a>iter &lt;-<span class="st"> </span><span class="dv">0</span>;E1 &lt;-<span class="st"> </span><span class="dv">0</span>;E2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true"></a><span class="cf">while</span>(iter <span class="op">&lt;</span><span class="st"> </span><span class="dv">200</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(E1<span class="op">-</span>E2)<span class="op">&gt;</span><span class="st"> </span><span class="fl">1e-6</span>){</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true"></a>  output &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>),likelihood_e,<span class="dt">p0 =</span> p0,<span class="dt">q0 =</span> q0)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true"></a>  E1 &lt;-<span class="st"> </span>E2;E2 &lt;-<span class="st"> </span>output<span class="op">$</span>value</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true"></a>  p0 &lt;-<span class="st"> </span>output<span class="op">$</span>par[<span class="dv">1</span>]</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true"></a>  q0 &lt;-<span class="st"> </span>output<span class="op">$</span>par[<span class="dv">2</span>]</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true"></a>  iter &lt;-<span class="st"> </span>iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true"></a>}</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true"></a>estimate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0,q0,iter)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true"></a><span class="kw">colnames</span>(estimate) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;iteration times&quot;</span>)</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(estimate)</span></code></pre></div>
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Exercises 3 (page 204, Advanced R)</li>
</ul>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true"></a>)</span></code></pre></div>
<ul>
<li><strong>Answer 2</strong></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true"></a>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true"></a><span class="co">#Use for loops</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true"></a>models.loop &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true"></a>  models.loop &lt;-<span class="st"> </span><span class="kw">c</span>(models.loop,<span class="kw">list</span>(<span class="kw">lm</span>(formulas[[i]],<span class="dt">data =</span> mtcars)))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true"></a>}</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true"></a><span class="co">#use lapply</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true"></a>models &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas,lm,<span class="dt">data =</span> mtcars)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true"></a>models</span></code></pre></div>
</div>
<div id="question-3-1" class="section level3">
<h3>Question 3</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>  <span class="dv">100</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using it directly.</p>
<ul>
<li><strong>Answer 3</strong></li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a>  <span class="dv">100</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true"></a>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i){trials[[i]]<span class="op">$</span>p.value}),<span class="dv">3</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true"></a><span class="co">#Use the[[ to get rid of anonymous function.</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;p.value&quot;</span>),<span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<ul>
<li><strong>Answer 4</strong></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a>testlist &lt;-<span class="st"> </span><span class="kw">list</span>(iris, mtcars, cars) </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>lmapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){ </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X) </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a><span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))} </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>out </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>} </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a><span class="kw">lmapply</span>(testlist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)) </span></code></pre></div>
<p>2020-12-01</p>
</div>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p>1.Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).<br />
2. Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.<br />
3. Campare the computation time of the two functions with the function “microbenchmark”.<br />
4. Comments your results.Write an Rcpp function for Exercise 9.4 .</p>
<ul>
<li><strong>Answer 1</strong></li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1227</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true"></a>  x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true"></a>  x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true"></a>  k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true"></a>    <span class="cf">else</span> {</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true"></a>      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true"></a>    }</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true"></a>  }</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true"></a>}</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true"></a><span class="kw">cppFunction</span>(<span class="st">&#39;List rw_Metropolis_cpp(double sigma, double x0, int N) {</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true"></a><span class="st">  List out(2);</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true"></a><span class="st">  x[0] = x0;</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true"></a><span class="st">  DoubleVector u = runif(N);</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true"></a><span class="st">  int k=0;</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true"></a><span class="st">  for(int i=1;i &lt; N; i++) {</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true"></a><span class="st">    double y = as&lt;double&gt;(rnorm(1, x[i-1], sigma));</span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true"></a><span class="st">    if (u[i] &lt;= exp(abs(x[i-1])-abs(y))) {</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true"></a><span class="st">      x[i] = y;</span></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true"></a><span class="st">    else{</span></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true"></a><span class="st">      x[i] = x[i-1];</span></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true"></a><span class="st">      k = k + 1;</span></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true"></a><span class="st">  }</span></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true"></a><span class="st">  out[0] = x;</span></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true"></a><span class="st">  out[1] = k;</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true"></a><span class="st">  return (out);</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true"></a><span class="st">}&#39;</span>)</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true"></a></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true"></a></span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true"></a>rej =<span class="st"> </span><span class="kw">numeric</span>()</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true"></a>rej_c =<span class="st"> </span><span class="kw">numeric</span>()</span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true"></a><span class="co">#chains</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true"></a>  rw =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i],x0,N)<span class="op">$</span>x</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true"></a>  rw_c =<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma[i],x0,N)[[<span class="dv">1</span>]]</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true"></a>  <span class="kw">plot</span>(rw, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true"></a>       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[i],<span class="dv">3</span>))),</span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true"></a>       <span class="dt">ylab=</span><span class="st">&quot;from R&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw))</span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true"></a>  <span class="kw">plot</span>(rw_c, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true"></a>       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[i],<span class="dv">3</span>))),</span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true"></a>       <span class="dt">ylab=</span><span class="st">&quot;from Rcpp&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw_c))</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true"></a>  rej[i] =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i],x0,N)<span class="op">$</span>k</span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true"></a>  rej_c[i] =<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma[i],x0,N)[[<span class="dv">2</span>]]</span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true"></a>}</span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true"></a></span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true"></a><span class="co">#accept rate</span></span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true"></a>acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>rej)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true"></a>acc_c =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>rej_c)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true"></a>res =<span class="st"> </span><span class="kw">rbind</span>(acc, acc_c)</span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true"></a><span class="kw">rownames</span>(res) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Accept rates from R&quot;</span>,<span class="st">&quot;Accept rates from Rcpp&quot;</span>)</span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true"></a><span class="kw">colnames</span>(res) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(res)</span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true"></a></span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true"></a></span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true"></a><span class="co">#qqplot</span></span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true"></a>  rw =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i],x0,N)<span class="op">$</span>x</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true"></a>  rw_c =<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma[i],x0,N)[[<span class="dv">1</span>]]</span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true"></a>  <span class="kw">qqplot</span>(rw, rw_c, <span class="dt">xlab =</span> <span class="st">&quot;from R&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;from Rcpp&quot;</span>, <span class="dt">main =</span> <span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])))</span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(x) x</span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true"></a>  <span class="kw">curve</span>(f, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>,<span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true"></a>}</span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true"></a></span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true"></a><span class="co">#Campare the computation time of the two functions with the function “microbenchmark”</span></span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true"></a>  ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(rw &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i],x0,N),</span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true"></a>                       rw_c &lt;-<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma[i],x0,N))</span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true"></a>  time &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true"></a>  <span class="kw">rownames</span>(time) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma[i],<span class="st">&quot;from R&quot;</span>),<span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma[i],<span class="st">&quot;from Rcpp&quot;</span>))</span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true"></a>  <span class="kw">print</span>(knitr<span class="op">::</span><span class="kw">kable</span>(time))</span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true"></a>}</span></code></pre></div>
<p>We can conclude that the Rcpp function implement the same work as the R function do, the acceptance rate from two chains is similar, but Rcpp function consume much less time.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
